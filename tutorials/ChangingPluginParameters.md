# Overview #

The RobotX-specific behavior of the models and the environment is generated by a set of [Gazebo Model Plugins](http://gazebosim.org/tutorials?tut=plugins_hello_world).  The current models used in these plugins are described in the Theory of Operation Document [PDF on Github](https://github.com/bsb808/robotx_docs/blob/master/theoryofoperation/theory_of_operation.pdf).  The parameters of the associated models (USV drag coefficient, wind speed, etc.) can be changed through the use of SDF configuration files.

This tutorial briefly describes where the base parameter files that are included with this repository are stored so that users can change the parameters to test their solutions under a variety of conditions.

| Description | File Location | Notes |
|-------------|---------------|------ |
| Hydrodynamic parameters (drag, added mass, etc.) | wamv_gazebo/urdf/dynamics/wamv_gazebo_dynamics_plugin.xacro | Current parameters based on FAU Publication https://doi.org/10.1016/j.oceaneng.2016.09.037 |
| Wave characteristics (amplitude, period and direction for three constituents) |  wamv_gazebo/urdf/dynamics/wamv_gazebo_dynamics_plugin.xacro | Values correspond to same values used in visual texture |
| Propulsion characteristics (linear or nonlinear mapping and force limits) | wamv_gazebo/urdf/thruster_layouts/wamv_gazebo_thruster_config.xacro | Nonlinear mapping is based on experimental results from FAU https://doi.org/10.1016/j.oceaneng.2016.09.037 |
| Wind velocity and windage coefficients | vrx_gazebo/worlds/sandisland.world.xacro | Windage coefficeints from same FAU report https://doi.org/10.1016/j.oceaneng.2016.09.037 |



# Example: Changing the Wind #
As an illustrative example, we'll go through testing our simulation with different wind conditions.  The wind is specified in the ```wamv_gazebo/urdf/dynamics/wamv_gazebo_wind_plugin.xacro``` file by specifying the velocity vector (in m/s) and the coefficients used to convert the apparent wind into force and torque.

If you edit the xacro file you will see a line like this...

```
<wind_velocity_vector>0 0 0 </wind_velocity_vector>
```

which in this case specifies the wind velocity as 0 m/s.  We can change the X and Y components of this vector to simulate the influence of wind on the vessel (the Z component is ignored).  We've posted a [video](https://vimeo.com/257588911) where we experiment with a couple of cases.
#[WIP]#
# Example: Changing the Wind #
As an illustrative example, we'll go through testing our simulation with different wind conditions.  The wind is specified in the world file being run.
If you view the sandisland.world.xacro file you will see lines like this...

```
<xacro:include filename="$(find vrx_gazebo)/worlds/xacros/gazebo_wind_plugin.xacro"/>
<xacro:usv_wind_gazebo>
  <wind_objs>
    <wind_obj>         
      <name>wamv</name>
      <link_name>base_link</link_name>
      <coeff_vector>0.5 0.5 0.33</coeff_vector>
    </wind_obj>
  </wind_objs>
</xacro:usv_wind_gazebo>
```
NOTE: see vrx_gazebo/worlds/xacros/gazebo_wind_plugin.xacro for all parameters and default values

which in this case specifies the wind velocity as 10 m/s(default). It also specifies that wamv model is the only wind object (model to be effected by the wind), the link of wamv which will be pushed on is base_link and its coefficient vector is .5 .5 .33.

Any number of wind_obj's may be added under wind_objs.
Only one link per model is supported.

NOTE: For another example, see vrx_gazebo/worlds/wind_test.world.xacro

# Example: Changing the Wave Field #

As an illustrative example, we'll go through testing the simulation with different wave scenarios.  The wave field characteristics are defined in `wamv_gazebo/urdf/dynamics/wamv_gazebo_dynamics_plugin.xacro`.  When we open the file we see a section that looks like this...

```
	<!-- Waves x3 -->
	<wave_n>3</wave_n>

	<wave_amp0>0.06</wave_amp0>
	<wave_period0>12.6</wave_period0>
	<wave_direction0>-1 0</wave_direction0>

	<wave_amp1>0.04</wave_amp1>
	<wave_period1>3.7</wave_period1>
	<wave_direction1>-0.7 0.7</wave_direction1>

	<wave_amp2>0.03</wave_amp2>
	<wave_period2>6.3</wave_period2>
	<wave_direction2>0.7 0.7</wave_direction2>
```

This specifies our Gerstner wave field as having three components, where each component has a user-specified  amplitude, period and direction.

When we start testing a new algorithm, we may want to set all of these to zero, so that there is no influence from the wave field.  We could achieve that by setting the amplitude of each component wave to zero - or we could set the `wave_n` parameter to zero so there are no components.

Alternatively, we may want to stress our algorithm by increasing the seastate.  This can be accomplished by increasing the amplitude of the waves and/or changing the wave period.

We've posted a [video](https://vimeo.com/257586610) showing how we would test with three different seastates - including how to break a buoy!